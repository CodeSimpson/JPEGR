## 1. JPEG如何保存

JPEG图片格式组成为：

粗体为JPEG组成中的必须部分。

| 名称       | 标记码 | 含义         |
| :------- | :-- | :--------- |
| **SOI**  |     | 文件头        |
| **APP0** |     | 图像识别信息     |
| **DQT**  |     | 定义量化表      |
| **SOF0** |     | 图像基本信息     |
| **DHT**  |     | 定义Huffman表 |
| DRI      |     | 定义重新开始间隔   |
| **SOS**  |     | 扫描行开始      |
| **EOI**  |     | 文件尾        |

### 1.1 Android如何识别JPEG文件？

原理非常简单，通过判断jpeg二进制文件的前3个字节是否是以**FF D8 FF**开始，如果是就认为它是JPEG图。

### 1.2 JPEG文件的段结构

JPEG文件以段的形式来存储信息，段的多少和长度不固定。JPEG的每个段一定都包含四个部分：**段标识**、**段类型**、**段长度**以及**段内容**。段标识的标记码为一个字节长度的十六进制数0xFF，段类型也是一个字节长度的十六进制数，对于不同的段，它的值也不同。

紧接着两个字节存放段长度（==这个长度包含段内容和段长度本身，不包括段标识和段类型这两个字节长度==）。

注意：这个长度的表示方法是按照高位在前，低位在后的，与 Intel 的表示方法不同。比方说一个段的长度是0x12AB，那么它会按照0x12，0xAB的顺序存储。但是如果按照Intel的方式：高位在后，低位在前的方式会存储成0xAB，0x12，而这样的存储方法对于JPEG是不对的。这样的话如果一个程序不认识JPEG文件某个段，它就可以读取后两个字节，得到这个段的长度，并跳过忽略它。

| 名称   | 字节数 | 标识码 | 说明                   |
| ------ | ------ | ------ | ---------------------- |
| 段标识 | 1      | 0xFF   | 每个新段的开始标识     |
| 段类型 | 1      | 0xXX   | 类型编码，也成为标记码 |
| 段长度 | 2      | 0xXXXX | 包括段内容和段长度本身 |
| 段内容 |        |        | <= 65533 Byte          |



> 参考: <https://blog.csdn.net/huabiaochen/article/details/108044123>

